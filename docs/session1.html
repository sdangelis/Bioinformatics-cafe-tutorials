<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Session 1</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">[BETA] R tutorial</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="setup.html">setup</a>
</li>
<li>
  <a href="session1.html">session 1</a>
</li>
<li>
  <a href="packages.html">packages</a>
</li>
<li>
  <a href="session2.html">session 2</a>
</li>
<li>
  <a href="session3.html">session 3</a>
</li>
<li>
  <a href="reading.html">reading &amp; resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Session 1</h1>

</div>


<p>Welcome to the First session! By now the basic thing</p>
<p>Today, We’ll go over how variables can be stored together and start analyzing some patient data from The Cancer Genome Atlas.</p>
<div id="data-structures" class="section level1">
<h1>Data Structures</h1>
<p>So far we have seen variables made of single values. R has some pretty powerful data structures to store multiple, related values</p>
<div id="vectors" class="section level2">
<h2>vectors</h2>
<p>a vector is a collection of items<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. We create a vector by using the <code>c(item1,item2,item3)</code> function.</p>
<pre class="r"><code>numbers &lt;- c(1, 2, 3, 4, 5)</code></pre>
<p>we can assign a name to each element in the vector by assigning a vector of names to the <code>names()</code> function. Note <code>names()</code> assigns the name in place<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, i.e it doesn’t create a new vector with the names we have to assign to a variable</p>
<pre class="r"><code>names(numbers) &lt;- c(&quot;n1&quot;, &quot;n2&quot;, &quot;n3&quot;, &quot;n4&quot;, &quot;n5&quot;)</code></pre>
<p>or by providing them before the values when we create the vector.</p>
<pre class="r"><code>numbers &lt;- c(&quot;n1&quot; = 1, &quot;n2&quot; = 2, &quot;n3&quot; = 3, &quot;n4&quot; = 4)</code></pre>
<p>The <code>names()</code> function can also be used alone to get the names of a vector</p>
<pre class="r"><code>names(numbers)</code></pre>
<pre><code>## [1] &quot;n1&quot; &quot;n2&quot; &quot;n3&quot; &quot;n4&quot;</code></pre>
<p>All items in a vector must be of the same type. if we try to mix instance letters and numbers, R will force (coherce) all items to be the most general type. The character type is always the most general type.</p>
<pre class="r"><code>numbers2 &lt;- c(1,2L, 1+2i, &quot;three&quot;)</code></pre>
<pre class="r"><code>typeof(numbers2)</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Try to come up with a case for why this could be a problem.</p>
<p>Your turn, create a vector to store the first 6 letters of the alphabet. What will be the resulting type?</p>
<pre class="r"><code>(letters &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;))</code></pre>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot;</code></pre>
</div>
<div id="lists" class="section level2">
<h2>lists</h2>
<p>Lists are similar to vectors but can contain items of different types, without the need to cohere to the most general type.</p>
<pre class="r"><code>list &lt;- list(2,1,&quot;a&quot;)</code></pre>
<p>Because of this lists are as whole of type list,</p>
<pre class="r"><code>typeof(list)</code></pre>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>The environment panel of RStudio can be used to easily see what a list contains.<br />
Another difference from vectors is that lists are recursive i.e a list can contain lists of things while a vector will always expand to a 1-dimensional flat structure</p>
<pre class="r"><code>c(c(1,2),c(3,4))</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<pre class="r"><code>list(list(&quot;1&quot;,&quot;2&quot;), list(&quot;3&quot;,&quot;4&quot;))</code></pre>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] &quot;1&quot;
## 
## [[1]][[2]]
## [1] &quot;2&quot;
## 
## 
## [[2]]
## [[2]][[1]]
## [1] &quot;3&quot;
## 
## [[2]][[2]]
## [1] &quot;4&quot;</code></pre>
<p>try it yourself, create a list containing 3 items named item1, item2, item3 and print their names to screen. HINT: names in lists work similarly to vectors</p>
<pre class="r fold-hide"><code>named_list &lt;- list(1, 2, 3)
names(named_list) &lt;- c(&quot;item1&quot;, &quot;item2&quot;, &quot;item3&quot;)
names(named_list)</code></pre>
<pre><code>## [1] &quot;item1&quot; &quot;item2&quot; &quot;item3&quot;</code></pre>
</div>
<div id="data-frames" class="section level2">
<h2>data frames</h2>
<p>data frames are the most commonly used structure in R. Think of them as tables in a spreadsheet. They are 2-dimensional. The only constraint is that all the values in each column must be of the same type.</p>
<p>We can create a data frame with <code>data.frame()</code>. Each column is specified with the <code>name = vector</code> syntax. We separate columns with a commma</p>
<pre class="r"><code>(cells &lt;- data.frame(&quot;plate&quot; = c(1, 2, 3, 4), &quot;Doubling_time&quot; = c(10, 20, 10, 40), &quot;cell_line&quot; = c(&quot;HC70&quot;, &quot;HCC1400&quot;, &quot;HCC1500&quot;, &quot;BT-20&quot;)))</code></pre>
<pre><code>##   plate Doubling_time cell_line
## 1     1            10      HC70
## 2     2            20   HCC1400
## 3     3            10   HCC1500
## 4     4            40     BT-20</code></pre>
<p>Of course we can define the vectors separately and then bundle them.</p>
<pre class="r"><code>plate = c(1, 2, 3, 4)
Doubling_time = c(10, 20, 10, 40)
cell_line = c(&quot;HC70&quot;, &quot;HCC1400&quot;, &quot;HCC1500&quot;, &quot;BT-20&quot;)
cells &lt;- (data.frame(plate, Doubling_time, cell_line))</code></pre>
<p>Names in a data table have 3 layers. - column names - row names - item names</p>
<p>We can view column names with <code>colnames(frame)</code> and edit them with <code>colnames(frame) &lt;- names</code>.<br />
for instance, we can rename all columns in our cells to consistently start with a capital letter<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<pre class="r"><code>colnames(cells) &lt;- c(&quot;Plate&quot;, &quot;Doubling_time&quot;, &quot;Cell_line&quot;)
cells</code></pre>
<pre><code>##   Plate Doubling_time Cell_line
## 1     1            10      HC70
## 2     2            20   HCC1400
## 3     3            10   HCC1500
## 4     4            40     BT-20</code></pre>
<p>Row names work like column names but we use the <code>rownames(frame)</code> function It is tempting to use row names to encode an identifier instead of using an ID column (in our example this was Plate). some - old style - R functions expect this. However these days doing so is discouraged as row names cannot be accessed as if they were a normal column.</p>
<p>Like with vectors <code>names()</code> allows us to edit and access the name of individual items.<br />
Usually indidivual names are not useful as we should be able to identify each value by column and row.</p>
<p>Finally, there are some other useful functions with dataframes. <code>dim()</code> returns the dimensions (rows, columns) of a data frame</p>
<pre class="r"><code>dim(cells)</code></pre>
<pre><code>## [1] 4 3</code></pre>
<p>while <code>nrow()</code>,<code>ncol()</code> return the number of rows and columns, respectively</p>
<pre class="r"><code>nrow(cells)</code></pre>
<pre><code>## [1] 4</code></pre>
<pre class="r"><code>ncol(cells)</code></pre>
<pre><code>## [1] 3</code></pre>
<p>Remember, Unlike excel however, formulas are recorded in your script/console, not the data frame itself. The frame simply stores values</p>
</div>
<div id="matrices" class="section level2">
<h2>matrices</h2>
<p>a matrix is a table, or precisely a 2 dimensional vector. Like vectors they can contain only one type of data. we can create a matrix of sizes i, j by calling <code>matrix(vector_with_data, nrow=i, ncol=j, dimnames(list_of_names))</code>.</p>
<pre class="r"><code>matrix(data = c(1,2,3,4), nrow = 2, ncol = 2, dimnames = list(list(&quot;a&quot;,&quot;b&quot;), list(&quot;c&quot;, &quot;d&quot;)))</code></pre>
<pre><code>##   c d
## a 1 3
## b 2 4</code></pre>
<p>unless we specify <code>byrow = T</code>, matrices are populated column by column. Dimension names are always taken row names then columns</p>
<pre class="r"><code>matrix(data = c(1,2,3,4), nrow = 2, ncol = 2, dimnames = list(list(&quot;a&quot;,&quot;b&quot;), list(&quot;c&quot;, &quot;d&quot;)), byrow = T)</code></pre>
<pre><code>##   c d
## a 1 2
## b 3 4</code></pre>
<p>Matrices are not very flexible as a place to store data but are really good for mathematical operations, which is what they tend to be used for.</p>
</div>
<div id="maths-on-vectors-matrices-and-data-frames" class="section level2">
<h2>Maths on Vectors, matrices and data frames</h2>
<p>We can apply maths to vectors too, in this case the operation will be applied to every element of the vector.</p>
<p>For instance can increase all numbers by 1</p>
<pre class="r"><code>numbers = c(1, 2, 3, 4, 5)
numbers + 1</code></pre>
<pre><code>## [1] 2 3 4 5 6</code></pre>
<p>when using operations on 2 vectors we apply it element by element.</p>
<pre class="r"><code>c(2, 3, 4) + c(3, 2, 4)</code></pre>
<pre><code>## [1] 5 5 8</code></pre>
<p>R vectors have a somewhat surprising behavior when we operate on items of different length. we have seen a length of 1 leads to the item being recycled Else the longer one should be a multiple of the longer</p>
<pre class="r"><code>c(1,2,3,4) * c(1,2)</code></pre>
<pre><code>## [1] 1 4 3 8</code></pre>
<p>However, because we can do it, it doesn’t mean we should be typically. Think about how the result will look like before doing so.</p>
<p>similarly we can apply mathematical operations on a whole matrix</p>
<pre class="r"><code>numbers_matrix &lt;- matrix(data = c(1,2,3,4), nrow = 2, ncol = 2, dimnames = list(list(&quot;a&quot;,&quot;b&quot;), list(&quot;c&quot;, &quot;d&quot;)))</code></pre>
<pre class="r"><code>numbers_matrix * 2</code></pre>
<pre><code>##   c d
## a 2 6
## b 4 8</code></pre>
<p>Data frames are a bit tricker, as not all columns are numbers.</p>
<pre class="r"><code>cells+1</code></pre>
<pre><code>## Error in FUN(left, right): non-numeric argument to binary operator</code></pre>
<p>We’ll see some ways to only select the columns we need.</p>
</div>
<div id="arrays" class="section level2">
<h2>Arrays</h2>
<p>Arrays are higher dimensional objects. In fact, vectors are just a special 1-dimensional array, matrices are a 2-dimensional array. Be aware they exist.</p>
</div>
<div id="s3-s4-and-r6-object-system" class="section level2">
<h2>S3, S4 and R6 object system</h2>
<p>More complex objects made of a collection of these structures can be implemented in R. This is often done to represent specialized objects that have associated methods, or specialized variants of a function<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. We will come across some examples of this in <a href="session3.Rmd">session 3</a>. For now just be aware that more complex structures can exist.</p>
</div>
</div>
<div id="subsetting" class="section level1">
<h1>Subsetting</h1>
<div id="subestting-vectors" class="section level2">
<h2>Subestting vectors</h2>
<p>In R items are numbered from 1 <a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. We can use the <code>vector[index]</code> operator to get the element at that index</p>
<p>Remember the numbers vector, we can get the second number with</p>
<pre class="r"><code>numbers[2]</code></pre>
<pre><code>## [1] 2</code></pre>
<p>try to select numbers 1 and 3. Hint you can use a vector of indices with as your index</p>
<pre class="r"><code>numbers[c(1,3)]</code></pre>
<pre><code>## [1] 1 3</code></pre>
<p>we can also use <code>:</code> to return a sequence of numbers and use it to choose all elements from x to y. In R sequences are inclusive<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<pre class="r"><code>numbers[2:4]</code></pre>
<pre><code>## [1] 2 3 4</code></pre>
<p><em>Note</em> if you come from Python, you might be used to not needing a start or an end for <code>[:]</code> to get all the items from/to an index. This doesn`t work in R.</p>
<pre class="r"><code>numbers[:3]</code></pre>
<pre><code>## Error: &lt;text&gt;:1:9: unexpected &#39;:&#39;
## 1: numbers[:
##             ^</code></pre>
<p>We can combine sequences and single values Now try selecting all items from 1 to 3 and item 5.</p>
<pre class="r"><code>numbers[c(1:3,5)]</code></pre>
<pre><code>## [1] 1 2 3 5</code></pre>
<p>We can also remove values at an index by using <code>[-index]</code>. try to remove the 3rd item.</p>
<pre class="r"><code>numbers[[3]]</code></pre>
<pre><code>## [1] 3</code></pre>
</div>
<div id="subsetting-lists" class="section level2">
<h2>Subsetting lists</h2>
<p>Indices in lists work largely in the same way as in vectors. However, since lists are composed of other lists sub-setting with <code>[]</code> returns a list</p>
<pre class="r"><code>list[1]</code></pre>
<pre><code>## [[1]]
## [1] 2</code></pre>
<p>to get the actual elements we can use the double bracket <code>[[]]</code> operator. it works like <code>[]</code> but does not support negative indexes.</p>
<pre class="r"><code>list[[1]]</code></pre>
<pre><code>## [1] 2</code></pre>
<p>If we have a named list, we can use <code>[[]]</code> for names too.</p>
<pre class="r"><code>named_list[[&quot;item1&quot;]]</code></pre>
<pre><code>## [1] 1</code></pre>
<p>Although typically we use the <code>$name</code> shortcut</p>
<pre class="r"><code>named_list$item1</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="subsetting-matrices" class="section level2">
<h2>Subsetting matrices</h2>
<p>matrices work like vectors but we can choose from 2 dimensions with <code>[row,column]</code></p>
<pre class="r"><code>numbers_matrix[1,2]</code></pre>
<pre><code>## [1] 3</code></pre>
<p>we can omit the row, or column but not the comma to get all columns or rows, respectively. So we can get all columns for the firt row with</p>
<pre class="r"><code>numbers_matrix[1,]</code></pre>
<pre><code>## c d 
## 1 3</code></pre>
<p>Or all the rows in the first column</p>
<pre class="r"><code>numbers_matrix[,1]</code></pre>
<pre><code>## a b 
## 1 2</code></pre>
<p>since matrices are vectors, we can select the individual elements without specifying columns or rows</p>
<pre class="r"><code>numbers_matrix[4]</code></pre>
<pre><code>## [1] 4</code></pre>
</div>
<div id="data-frames-1" class="section level2">
<h2>Data Frames</h2>
<p>Data frames behave like matrices with <code>[row, column]</code> indices. Unlike matrices or lists, the <code>[]</code> operator can return either a vector or a data frame. <em>Normally</em> there is no need to worry about this.</p>
<pre class="r"><code>cells[1,3]</code></pre>
<pre><code>## [1] &quot;HC70&quot;</code></pre>
<p>The matrix trick to get all columns or rows for a given row or column trick works here too</p>
<pre class="r"><code>cells[1,]</code></pre>
<pre><code>##   Plate Doubling_time Cell_line
## 1     1            10      HC70</code></pre>
<pre class="r"><code>cells[,1]</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>For a data frame the <code>[index]</code> syntax will return the specified column(s) as a data frame</p>
<pre class="r"><code>cells[1]</code></pre>
<pre><code>##   Plate
## 1     1
## 2     2
## 3     3
## 4     4</code></pre>
<p><code>[[]]</code> is less useful for data frames. it does not support the empty row/column syntax</p>
<pre class="r"><code>cells[[1,]]</code></pre>
<pre><code>## Error in `[[.data.frame`(cells, 1, ): argument &quot;..2&quot; is missing, with no default</code></pre>
<pre class="r"><code>cells[[,1]]</code></pre>
<pre><code>## Error in `[[.data.frame`(cells, , 1): argument &quot;..1&quot; is missing, with no default</code></pre>
<p>but <code>[[index]]</code> returns a vector with the column, rather than a data frame with the column</p>
<pre class="r"><code>cells[[1]]</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>As for named lists, <code>$name</code> returns the column as a vector</p>
<pre class="r"><code>cells$Plate</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>If we assign values to a column that doesn’t exist we can add it to the data frame (like <code>names()</code> this happens in place<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>). Traditionally we use <code>$name</code> here to create a new column with the given name. <em>NOTE</em> The cell lines, their features and their sources here are fictional.</p>
<pre class="r"><code>cells$source &lt;- c(&quot;ATCC&quot;, &quot;ATCC&quot;, &quot;ECACC&quot;, &quot;ATCC&quot;)</code></pre>
<p>now our table has an extra row:</p>
<pre class="r"><code>cells</code></pre>
<pre><code>##   Plate Doubling_time Cell_line source
## 1     1            10      HC70   ATCC
## 2     2            20   HCC1400   ATCC
## 3     3            10   HCC1500  ECACC
## 4     4            40     BT-20   ATCC</code></pre>
<p>Assigning a column to <code>NULL</code> deletes it.</p>
<pre class="r"><code>cells$source &lt;- NULL</code></pre>
<pre class="r"><code>cells</code></pre>
<pre><code>##   Plate Doubling_time Cell_line
## 1     1            10      HC70
## 2     2            20   HCC1400
## 3     3            10   HCC1500
## 4     4            40     BT-20</code></pre>
</div>
</div>
<div id="reading-tabular-data" class="section level1">
<h1>Reading Tabular Data</h1>
<p>We have seen how to create and represent tabular data in R with a data frame, Typically we load a data set from a file.</p>
<p>There are packages to load Excel files but typically we remove all the Excel specific information and export tabular data as a plain text file. In these files each line represents a row, with the columns within each line separated by a delimiter character. if the delimiter is a tab character we get a tab separated value (tsv) file, if the delimiter is a comma we get a comma separated value (csv) file. For instance, a stock room table like this</p>
<table>
<thead>
<tr class="header">
<th>Item</th>
<th>cabinet</th>
<th>shelf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TAE</td>
<td>A</td>
<td>1</td>
</tr>
<tr class="even">
<td>Agarose</td>
<td>A</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Ladder</td>
<td>B</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Would be represented as this in a csv file:</p>
<p>Item,Cabinet,Shelf<br />
TAE,A,1<br />
Agarose,A,2<br />
Ladder,B,1</p>
<p>TSV and CSV can be opened and saved in excel but you may need to specify the separator for TSV files and the resulting files might have be saved as <code>.txt</code> rather than <code>.tsv</code>.</p>
<p>In R we can read a table from plain text file with <code>read.table()</code>. we need to specify the separator, in the tab separated case it is <code>\t</code> Remember to store the table in a variable!</p>
<pre class="r"><code>data &lt;- read.table(&quot;table.txt&quot;, sep = &quot;\t&quot;)</code></pre>
<p>if we are reading a csv file we can use read.csv. There is no difference with read.table but the default arguments match a typical csv file.</p>
<pre class="r"><code>data &lt;- read.csv(&quot;table.csv&quot;)</code></pre>
<p>blank spaces as automa tically treated as missing data. Other conventions exists, so we e can specify a character that is interpreted as missing values to ensure R can represent them as NA with <code>na_strings</code>.</p>
<pre class="r"><code>data &lt;- read.csv()</code></pre>
</div>
<div id="analysis-of-tgca-data" class="section level1">
<h1>Analysis of TGCA data</h1>
<p>Now we undserstand how to get data into R, let’s try to open the data_clinical_patient.tsv file from the setup folder and save it as <code>patients</code>. This file has a header, a comment at the start and some missing values encoded as <code>na</code> or <code>missing</code> so we need to adjust some parametrs:</p>
<ol style="list-style-type: decimal">
<li>set # as the comment character (use the <code>comment.char</code> argument)</li>
<li>set the header argument to TRUE.</li>
<li>Use “na” and “missing” as the na.strings argument Hint you can pass a vector to na.strings()</li>
</ol>
<p>Remember to set the working directory to the right location first!</p>
<pre class="r"><code>patients &lt;- read.table(&quot;mel_ucla_2016/data_clinical_patient.txt&quot;, sep=&quot;\t&quot;, comment.char = &quot;#&quot;, header = T )</code></pre>
<div id="exploring-the-data" class="section level2">
<h2>Exploring the data</h2>
<p>let’s start by checking the dimensions of the table. Remeber a function to do that?</p>
<pre class="r"><code>dim(patients)</code></pre>
<pre><code>## [1] 38  9</code></pre>
<p>we can use <code>summary()</code> to get a quick summary of the data.</p>
<pre class="r"><code>summary(patients)</code></pre>
<pre><code>##   PATIENT_ID         OS_STATUS           OS_MONTHS         SEX            AGE_AT_DIAGNOSIS  TREATMENT        
##  Length:38          Length:38          Min.   : 1.80   Length:38          Min.   :19.00    Length:38         
##  Class :character   Class :character   1st Qu.:11.00   Class :character   1st Qu.:55.00    Class :character  
##  Mode  :character   Mode  :character   Median :18.00   Mode  :character   Median :61.50    Mode  :character  
##                                        Mean   :20.97                      Mean   :60.53                      
##                                        3rd Qu.:31.00                      3rd Qu.:69.75                      
##                                        Max.   :71.40                      Max.   :84.00                      
##                                        NA&#39;s   :1                                                             
##  DURABLE_CLINICAL_BENEFIT   M_STAGE          PREVIOUS_MAPKI    
##  Length:38                Length:38          Length:38         
##  Class :character         Class :character   Class :character  
##  Mode  :character         Mode  :character   Mode  :character  
##                                                                
##                                                                
##                                                                
## </code></pre>
<p>The resulting information is most useful for numerical columns or, as we’ll see in the next session facrtors.</p>
<p>We can use table to get counts for each value</p>
<pre class="r"><code>table(patients$OS_STATUS)</code></pre>
<pre><code>## 
##   0:LIVING 1:DECEASED 
##         19         19</code></pre>
<p>now try using table with the metastatic stage (M_STAGE)</p>
<pre class="r"><code>table(patients$M_STAGE)</code></pre>
<pre><code>## 
##  M0 M1a M1b M1c 
##   1   5   4  28</code></pre>
<p>We can combine <code>nrow()</code> and maths to get to percentages. We even get to keep the name of the values</p>
<pre class="r"><code>table(patients$M_STAGE)/nrow(patients)*100</code></pre>
<pre><code>## 
##        M0       M1a       M1b       M1c 
##  2.631579 13.157895 10.526316 73.684211</code></pre>
<p>For numerical variables we can use <code>min()</code>, <code>max()</code> and <code>range()</code> to get the minimum, maximum or both values for a column</p>
<pre class="r"><code>range(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>## [1] 19 84</code></pre>
<p>Depending on whether we expect our variable to be normally distributed or not we can start looking at how values are distributed A normal distribution looks like this - there is central value that is the most commonly observed and the remaining values are symmetrically distributed at either side of it:</p>
<pre class="r"><code>d &lt;- density(rnorm(1e6))
plot(d, ylab = &quot;Density&quot;, xlab = &quot;Value&quot;, main = &quot;Density plot for a normal distribution&quot;)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-63-1.png" width="672" /> Compare that with a non normal distribution.</p>
<pre class="r"><code>d &lt;- density(rbeta(1e6,shape1 = 5, shape2 = 2))
plot(d, ylab = &quot;Density&quot;, xlab = &quot;Value&quot;, main = &quot;Density plot for a non normal distribution&quot;)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-64-1.png" width="672" /> While there are formal tests for whether an observation follows a normal distribution, more often than not a quick histogram will let us judge if something is normal enough - we’ll see how to generate them.</p>
<div id="normal-variables" class="section level3">
<h3>Normal variables</h3>
<p>For now let’s assume the age at diagnosis is normally distributed. In this case we want the mean and standard deviation to represent the central value and the spread of our data. Remember in a normal distribution ~68% of the data will be in the mean ± sd range, ~ 95% of the data will be in the mean ± 2 sd range and ~99.7% within mean ± 3 sd We can get the mean and standard deviation with the <code>mean()</code> and <code>sd()</code> function.</p>
<pre class="r"><code>mean(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>## [1] 60.52632</code></pre>
<pre class="r"><code>sd(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>## [1] 14.42171</code></pre>
</div>
<div id="non-normal-variables" class="section level3">
<h3>Non-normal variables</h3>
<p>If instead we assume the age at diagnosis is not normally distributed, the central tendency and spread of our data is better represented by the median and the quantiles.<br />
<code>median()</code> will happily give us the median</p>
<pre class="r"><code>median(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>## [1] 61.5</code></pre>
<p>the <code>quantile()</code> function will show us the values for 4 quantiles The N-th quantile represents the value that contains n % of the samples</p>
<pre class="r"><code>quantile(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>##    0%   25%   50%   75%  100% 
## 19.00 55.00 61.50 69.75 84.00</code></pre>
<p>In this case the 75% of the values are contained between 19 and 69.75 75%.<br />
And <code>IQR()</code> will return the inter quantile range</p>
<pre class="r"><code>IQR(patients$AGE_AT_DIAGNOSIS)</code></pre>
<pre><code>## [1] 14.75</code></pre>
</div>
<div id="dealing-with-missigness" class="section level3">
<h3>Dealing with missigness</h3>
<p>What if we’re intersted in how many months of overall survival?</p>
<pre class="r"><code>mean(patients$OS_MONTHS)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>Looks like something is off. Looking at the summary, we have a <code>NA</code> value. NAs propagate through calculations <a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<p>We can simply deal with NA by either removing or ignoring them Imputation, or the art of predicting missing values is beyond the scope of this tutorial.</p>
<pre class="r"><code>missing &lt;- c(NA,NA,NA,NA,1,2,1,1,1,2,3)</code></pre>
<p>Some functions, such as mean can be told to remove NAs from using <code>na.rm = T</code></p>
<pre class="r"><code>mean(missing, na.rm = T)</code></pre>
<pre><code>## [1] 1.571429</code></pre>
<p>We can also manually remove all NAs with <code>na.omit()</code>.</p>
<pre class="r"><code>missing &lt;- na.omit(missing)</code></pre>
<p>W</p>
<p>If running on a data frame it will remove the whole rows consisting of any incomplete cases.</p>
<p>Now remove NAs from the table and save the new data frame in a variable called patients_complete. Na.omit on a data frame it will remove the whole rows consisting of any incomplete cases.</p>
<pre class="r fold-hide"><code>patients_complete &lt;- na.omit(patients)</code></pre>
<p>Whether we should ignore NA values from calculations or drop any case with a missing value is an analysis choice. Personally, I think it makes sense to ignore NAs if they are very sporadic. If NAs are concentrated in one or more columns, it may make sense to ignore columms where we have lots of missingness. Sometimes, especially if the NA values are in key columns we might want to consider complete cases only</p>
</div>
</div>
</div>
<div id="conditions" class="section level1">
<h1>Conditions</h1>
<p>We have seen we can get a column or a row by manually providing an index for the values we need. We can ask R to choose all that match one or more conditions Some of this will be familiar if you. Even if you’re familiar with it might be worth going quickly through this</p>
<div id="relational-operators" class="section level2">
<h2>Relational Operators</h2>
<p>We can use relational operators to ask about the relationship between two values. Most operators are intuitive but checking if something is equal is done with <code>==</code> rather than <code>=</code> because <code>=</code> is already used to assign values to variables</p>
<table>
<thead>
<tr class="header">
<th>operators</th>
<th>function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>==</td>
<td>equal to</td>
</tr>
<tr class="even">
<td>!=</td>
<td>not equal to</td>
</tr>
<tr class="odd">
<td>&gt;</td>
<td>more than</td>
</tr>
<tr class="even">
<td>&gt;=</td>
<td>more or equal to</td>
</tr>
<tr class="odd">
<td>&lt;</td>
<td>less than</td>
</tr>
<tr class="even">
<td>&lt;=</td>
<td>less or equal to</td>
</tr>
<tr class="odd">
<td>%in%</td>
<td>check in</td>
</tr>
<tr class="even">
<td>is.na()</td>
<td>check for NA values</td>
</tr>
</tbody>
</table>
<p>So if a is bigger than b, the following should be TRUE</p>
<pre class="r"><code>a = 1 
b = 2
1 &gt; 2</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Comparisons with NAs return NA</p>
<pre class="r"><code>a &gt; NA</code></pre>
<pre><code>## [1] NA</code></pre>
<p>to check if something is NA we cannot use <code>==</code> but need to use <code>is.na()</code></p>
<pre class="r"><code>NA == NA</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>is.na(NA)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p><code>%in%</code> attempts to match elements from the two vectors, regardless of their order or length</p>
<pre class="r"><code>c(1, 2, 3) %in% c(3, 2, 1)</code></pre>
<pre><code>## [1] TRUE TRUE TRUE</code></pre>
<p>Whereas <code>==</code> works element by element in order and would return FALSE for 1 and 3</p>
<pre class="r"><code>c(1, 2, 3) == c(3, 2, 1)</code></pre>
<pre><code>## [1] FALSE  TRUE FALSE</code></pre>
<p>Operators work on <code>TRUE</code> and <code>FALSE</code> values too. There is a slight distinction between using <code>==</code> and <code>isTRUE</code> and <code>isFALSE</code>. Using <code>==</code> 0 is interpreted as FALSE and 1 as TRUE.</p>
<pre class="r"><code>1 == T</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>0 == F</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>isTRUE and isFALSE check for an actual logical TRUE or FALSE value.</p>
<pre class="r"><code>isTRUE(1)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>like maths and relational operators boolean operators can compare two vectors element by element</p>
<pre class="r"><code>c(1,2,3) &lt; c(2,3,4)</code></pre>
<pre><code>## [1] TRUE TRUE TRUE</code></pre>
<p>operators work on characters too, but in a slightly different way: <code>&gt;, &lt;, &lt;=, &gt;=</code> work on alphabetical order</p>
<pre class="r"><code>&quot;a&quot;&gt;&quot;b&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>&quot;barts&quot; &lt; &quot;blizzard&quot;</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>However matching characters gets funny, and we’ll see how to deal with them in session 2.</p>
<pre class="r"><code>&quot;a&quot; %in% &quot;aereoplane&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="conditional-subsetting" class="section level2">
<h2>Conditional subsetting</h2>
<p>To conditionally subset a vector we can provide a condition for itself Remember our numbers vector, we can choose all numbers &gt; 2</p>
<pre class="r"><code>numbers[numbers &gt; 2]</code></pre>
<pre><code>## [1] 3 4 5</code></pre>
<p>for a data frame, we typically want to choose some or all rows where a specific column matches a condition.</p>
<pre class="r"><code>patients[patients$AGE_AT_DIAGNOSIS &lt; 40,]</code></pre>
<pre><code>##   PATIENT_ID  OS_STATUS OS_MONTHS    SEX AGE_AT_DIAGNOSIS     TREATMENT DURABLE_CLINICAL_BENEFIT M_STAGE
## 3       Pt11 1:DECEASED      15.3   Male               37 Pembrolizumab                       PD     M1c
## 6       Pt14   0:LIVING       1.8 Female               27 Pembrolizumab                       PD     M1c
## 8       Pt16 1:DECEASED       6.1   Male               19 Pembrolizumab                       PD     M1b
##   PREVIOUS_MAPKI
## 3             No
## 6             No
## 8            Yes</code></pre>
<p>Now let’s try to subset our table to choose only patients (rows) that were diagnosed after 65.</p>
<pre class="r fold-hide"><code>patients[patients$AGE_AT_DIAGNOSIS &gt; 65,]</code></pre>
<pre><code>##    PATIENT_ID  OS_STATUS OS_MONTHS    SEX AGE_AT_DIAGNOSIS     TREATMENT DURABLE_CLINICAL_BENEFIT M_STAGE
## 1         Pt1 1:DECEASED      19.9 Female               66 Pembrolizumab                       PD     M1b
## 7        Pt15 1:DECEASED      32.1   Male               70 Pembrolizumab                       PR     M1b
## 9        Pt17 1:DECEASED      31.2   Male               67 Pembrolizumab                       PD     M1a
## 17       Pt24 1:DECEASED      31.9   Male               70 Pembrolizumab                       PR     M1c
## 18       Pt25 1:DECEASED       8.6   Male               74 Pembrolizumab                       PD     M1c
## 19       Pt26   0:LIVING      43.8   Male               71 Pembrolizumab                       CR     M1c
## 20       Pt27   0:LIVING      18.0   Male               83 Pembrolizumab                       CR     M1c
## 21       Pt28 1:DECEASED      14.4   Male               82 Pembrolizumab                       PR     M1c
## 22       Pt29 1:DECEASED       8.8   Male               84 Pembrolizumab                       PD     M1c
## 24       Pt30 1:DECEASED       3.3 Female               80 Pembrolizumab                       PD     M1c
## 27       Pt33   0:LIVING      71.4 Female               80     Nivolumab                       CR     M1a
## 31       Pt37   0:LIVING      11.9 Female               70 Pembrolizumab                       PR     M1c
## 37        Pt8   0:LIVING        NA   Male               69 Pembrolizumab                       CR     M1a
## 38        Pt9   0:LIVING      34.6   Male               68 Pembrolizumab                       CR      M0
##    PREVIOUS_MAPKI
## 1              No
## 7             Yes
## 9              No
## 17             No
## 18            Yes
## 19            Yes
## 20             No
## 21             No
## 22            Yes
## 24             No
## 27             No
## 31            Yes
## 37             No
## 38             No</code></pre>
<p>Here the difference between <code>%in%</code> and <code>==</code> is crucial as the data frame will most likely be not ordered by the column we subset by</p>
</div>
<div id="logical-operators" class="section level2">
<h2>Logical operators</h2>
<p>The next step is to combine multiple conditions. They follow Boolean logic, with the exception of <code>NAs</code> that always propagate through</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Name</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&amp;</td>
<td>and</td>
<td>TRUE if both TRUE</td>
</tr>
<tr class="even">
<td>|</td>
<td>or</td>
<td>TRUE if A is TRUE or B is TRUE, or both are TRUE</td>
</tr>
<tr class="odd">
<td>xor()</td>
<td>exclusive (disjunctive) or</td>
<td>TRUE only if either A is TRUE OR b is TRUE</td>
</tr>
<tr class="even">
<td>!</td>
<td>negate</td>
<td>Negates the following expression</td>
</tr>
</tbody>
</table>
<p><code>&amp;</code> is TRUE only when both expressions are TRUE</p>
<pre class="r"><code>1 &lt; 2 &amp; 3 &gt; 4</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p><code>|</code> is TRUE when any expression is TRUE</p>
<pre class="r"><code>1 &lt; 2 | 3 &gt; 4 </code></pre>
<pre><code>## [1] TRUE</code></pre>
<p><code>|</code> is also TRUE when both are TRUE</p>
<pre class="r"><code>1 &lt; 2 | 3 &lt; 4</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>if we want to return FALSE when both are TRUE we can use the exclusive or <code>xor(expression 1, expression 2)</code></p>
<pre class="r"><code>xor(1 &lt; 2, 3 &lt; 4)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>! negates whatever follows</p>
<pre class="r"><code>!1 &gt; 2  </code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>As with other operators, they work on vectors too</p>
<pre class="r"><code>c(F, F, T) | c(T, F, F)</code></pre>
<pre><code>## [1]  TRUE FALSE  TRUE</code></pre>
<p>Now try selecting all the patients from the complete case table (<code>patients_complete</code>) with age of diagnosis below 40 <em>OR</em> above 65</p>
<pre class="r"><code>patients_complete[patients_complete$AGE_AT_DIAGNOSIS &lt; 40 | patients_complete$AGE_AT_DIAGNOSIS &gt; 65,]</code></pre>
<pre><code>##    PATIENT_ID  OS_STATUS OS_MONTHS    SEX AGE_AT_DIAGNOSIS     TREATMENT DURABLE_CLINICAL_BENEFIT M_STAGE
## 1         Pt1 1:DECEASED      19.9 Female               66 Pembrolizumab                       PD     M1b
## 3        Pt11 1:DECEASED      15.3   Male               37 Pembrolizumab                       PD     M1c
## 6        Pt14   0:LIVING       1.8 Female               27 Pembrolizumab                       PD     M1c
## 7        Pt15 1:DECEASED      32.1   Male               70 Pembrolizumab                       PR     M1b
## 8        Pt16 1:DECEASED       6.1   Male               19 Pembrolizumab                       PD     M1b
## 9        Pt17 1:DECEASED      31.2   Male               67 Pembrolizumab                       PD     M1a
## 17       Pt24 1:DECEASED      31.9   Male               70 Pembrolizumab                       PR     M1c
## 18       Pt25 1:DECEASED       8.6   Male               74 Pembrolizumab                       PD     M1c
## 19       Pt26   0:LIVING      43.8   Male               71 Pembrolizumab                       CR     M1c
## 20       Pt27   0:LIVING      18.0   Male               83 Pembrolizumab                       CR     M1c
## 21       Pt28 1:DECEASED      14.4   Male               82 Pembrolizumab                       PR     M1c
## 22       Pt29 1:DECEASED       8.8   Male               84 Pembrolizumab                       PD     M1c
## 24       Pt30 1:DECEASED       3.3 Female               80 Pembrolizumab                       PD     M1c
## 27       Pt33   0:LIVING      71.4 Female               80     Nivolumab                       CR     M1a
## 31       Pt37   0:LIVING      11.9 Female               70 Pembrolizumab                       PR     M1c
## 38        Pt9   0:LIVING      34.6   Male               68 Pembrolizumab                       CR      M0
##    PREVIOUS_MAPKI
## 1              No
## 3              No
## 6              No
## 7             Yes
## 8             Yes
## 9              No
## 17             No
## 18            Yes
## 19            Yes
## 20             No
## 21             No
## 22            Yes
## 24             No
## 27             No
## 31            Yes
## 38             No</code></pre>
</div>
</div>
<div id="common-statistical-tests" class="section level1">
<h1>Common statistical tests:</h1>
<p>Now we can create groups, we can start to explore their differences. As a statistic language R is loaded with a library of built-in statistical functions, we’ll barely scratch the surface here! There are 2 main families of tests: Parametric (for normally distributed variables) and non parametric (for non normally distributed ones) Before using a test we also need to check whether the assumptions are met before running any tests.</p>
<p>We’ll also very briefly discuss p-values. Note there is a whole world beyond p-values and lots of controversies over their (ab)use in biology <a href="https://doi.org/10.1038/d41586-019-00874-8">see this Nature Editorial</a> For simplicity we’ll use both non parametric and parametirc test on the same data.</p>
<div id="parametric-tests" class="section level2">
<h2>Parametric tests</h2>
<p>The t-test compares the means between two groups. In R, It uses the Welch variant that assumes an unequal variance, often a safe assumption. we need to provide 2 groups, we can do this by conditionally sub-setting</p>
<pre class="r"><code>t.test(x = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;], y = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;])</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;] and patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;]
## t = 1.4947, df = 31.623, p-value = 0.1449
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.429506 15.800935
## sample estimates:
## mean of x mean of y 
##  23.50000  16.81429</code></pre>
<p>we can store the p-value in a vector by choosing p.val from the result of the test.</p>
<pre class="r"><code>p_vals &lt;- t.test(x = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;], y = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;])$p.val</code></pre>
<p>The one-way anova tests the means between multiple groups, In R we can use the <code>aov</code> function. the syntax here is slightly odd, as we need to use the x ~ groups form. we also need to call summary to extract the P values and other information.</p>
<pre class="r"><code>anova &lt;- aov(patients_complete$OS_MONTHS ~ patients_complete$M_STAGE)
summary(anova)</code></pre>
<pre><code>##                           Df Sum Sq Mean Sq F value Pr(&gt;F)  
## patients_complete$M_STAGE  3   1273   424.3   2.411 0.0845 .
## Residuals                 33   5808   176.0                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>we can add our P value to the p values vector, to avoid overwriting we use the <code>append</code> function. Note <code>summary(anova)</code> returns a list, we can then subset until we get our P value.</p>
<pre class="r"><code>p_vals &lt;- append(p_vals, summary(anova)[[1]][5][1,1])</code></pre>
</div>
<div id="non-paramtetric-statistical-tests" class="section level2">
<h2>Non-paramtetric statistical tests</h2>
<p>the Wilcox rank sum test is a non parametric test similar to a T-test. Indeed the <code>wilcox.test()</code> function works in a similar way</p>
<pre class="r"><code>wilcox.test(x=patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;], y = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;])</code></pre>
<pre><code>## Warning in wilcox.test.default(x = patients_complete[patients_complete$PREVIOUS_MAPKI == : cannot compute
## exact p-value with ties</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;] and patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;]
## W = 210, p-value = 0.1288
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>We can again extract the p value an append it to our vector</p>
<pre class="r"><code>p_vals &lt;- append(p_vals,wilcox.test(x=patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;No&quot;, &quot;OS_MONTHS&quot;], y = patients_complete[patients_complete$PREVIOUS_MAPKI == &quot;Yes&quot;, &quot;OS_MONTHS&quot;])$p.val)</code></pre>
<pre><code>## Warning in wilcox.test.default(x = patients_complete[patients_complete$PREVIOUS_MAPKI == : cannot compute
## exact p-value with ties</code></pre>
<p>The Kruskal-Wallis rank sum test is often referred as a non parametric one way anova. we can run one with <code>kruskal.test()</code></p>
<pre class="r"><code>kruskal.test(patients_complete$OS_MONTHS ~ patients_complete$M_STAGE)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  patients_complete$OS_MONTHS by patients_complete$M_STAGE
## Kruskal-Wallis chi-squared = 4.235, df = 3, p-value = 0.2372</code></pre>
<p>getting the p-value is as easy as for the t and Wilcoxon tests</p>
<pre class="r"><code>p_vals &lt;- append(p_vals, kruskal.test(patients_complete$OS_MONTHS ~ patients_complete$M_STAGE)$p.val)</code></pre>
</div>
<div id="adjusting-the-p-value" class="section level2">
<h2>Adjusting the P-Value</h2>
<p>Traditionally, we reject the null hypothesis at the p&lt;0.05 level. This value represents a 1/20 chance of seeing a difference as big or greater by chance alone. It follows then that if we have 20 comparisons we can expect one to be TRUE by chance. Therefore, we need to adjust the p value to consider the number of comparisons. The “p-ajust()” function can then correct the observed p values for multiple comparisons with many methods. for instance we can use a bonferroni correction<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<pre class="r"><code>p.adjust(p_vals, method = &quot;bonferroni&quot;)</code></pre>
<pre><code>## [1] 0.5795994 0.3378689 0.5151183 0.9487212</code></pre>
<p>now do the same but with the FALSE discovery rate (FDR)<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> is. Hint type <code>?p.adjust</code> to see what methods corresponds to FDR</p>
<pre class="r fold-hide"><code>p.adjust(p_vals, method = &quot;fdr&quot;)</code></pre>
<pre><code>## [1] 0.1931998 0.1931998 0.1931998 0.2371803</code></pre>
<p>We can see the Bonferroni correction is more conservative than the FDR<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
</div>
</div>
<div id="base-r-plots" class="section level1">
<h1>Base R Plots</h1>
<p>base R plots can be displayed in the plots pane of R studio. *Note R will refuse to draw a plot if the plot panel is too small. Simple R plots can be generated quickly with base functions and can be extensively customised. We’ll also introduce the ggplot package that can generate publication quality plots with less effort in session 2.</p>
<p>R tracks every time we create a new plot so any items added to a plot get added to the lastly created plot.</p>
<div id="scatter-plots" class="section level2">
<h2>Scatter plots</h2>
<p>we can plot a scatter plot with <code>plot(x, y)</code></p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-108-1.png" width="672" /> we can add a trend line with <code>abline()</code>, following the format y=ax+b.</p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS)
abline(a = 1,b =+ 1)</code></pre>
<p>we can also add a vertical or horizontal line by specifying the intercept with h or v.</p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS)
abline(h = 10)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-110-1.png" width="672" /> We can also fit a line from more complex modeling, for instance from a linear regression. note <code>lm()</code> takes the y ~ x order.</p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS)
abline(lm(patients_complete$OS_MONTHS ~ patients_complete$AGE_AT_DIAGNOSIS))</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-111-1.png" width="672" /> We can change the two axis. ylim and xlim control the start and end of x and y axis. Be careful as R will clip off any value outside that range, again without warning</p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS, ylim = c(0,100), xlim = c(30,80))</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-112-1.png" width="672" /> We can also add a title and some label to the axis. We do this with main, xlab and ylab</p>
<pre class="r"><code>plot(patients_complete$AGE_AT_DIAGNOSIS, patients_complete$OS_MONTHS, main = &quot;this is the title&quot;, ylab = &quot;y axis&quot;, xlab = &quot;x axsis&quot;)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
<div id="histograms" class="section level2">
<h2>Histograms</h2>
<p>Histograms can be used to visualize the distribution of values in a variable. In base r we can generate one with <code>hist()</code></p>
<pre class="r"><code>hist(patients_complete$OS_MONTHS)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-114-1.png" width="672" /> Again, we can control several parameters, We can manually specify the number of breaks rather than use what number R thinks appropriate</p>
<pre class="r"><code>hist(patients_complete$OS_MONTHS, breaks=4)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-115-1.png" width="672" /> we can also add a colour and add a density line. To do so we need to switch to plotting probabilities with probability=T in the hist function.</p>
<pre class="r"><code>hist(patients_complete$OS_MONTHS, col=&quot;pink&quot;, probability = T)
lines(density(patients_complete$OS_MONTHS), col=&quot;purple&quot;)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-116-1.png" width="672" /> Axis and plot labels work similarly to the scatter plot above, try to redo the first histogram but change the labels so they are nicer</p>
<pre class="r"><code>hist(patients_complete$OS_MONTHS, ylab = &quot;Frequency&quot;, xlab=&quot;Overal Survivial (months)&quot;, main = &quot;overall survival&quot;)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-117-1.png" width="672" /> ## Box plots</p>
<p>Box Plots show the median value and distribution of a variable between 2 or more groups. We can use the <code>boxplot()</code> function for this.</p>
<pre class="r"><code>boxplot(patients_complete$OS_MONTHS~patients_complete$M_STAGE)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-118-1.png" width="672" /> By default the whiskers extend to 1.5x the interquartile range of each gruop. we can change the multiplier by specifying it to range.</p>
<pre class="r"><code>boxplot(patients_complete$OS_MONTHS~patients_complete$M_STAGE, range=0.4)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-119-1.png" width="672" /> We can even control the shape of the outlier points with pch. <code>?points</code> reveal what each value corresponds to.</p>
<pre class="r"><code>boxplot(patients_complete$OS_MONTHS~patients_complete$M_STAGE, range=0.4, pch=18)</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p>Now let’s add some colour to the plot. Try adding colours to the plot above with the “col” argument. hint, if you don’t want to have the groups use the same colour(s), specify a number of colours in the colour vector matching the number of groups</p>
<pre class="r fold-hide"><code>boxplot(patients_complete$OS_MONTHS~patients_complete$M_STAGE, range = 0.4, pch = 18, col = c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;yellow&quot;))</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
<div id="saving-plots" class="section level2">
<h2>Saving plots</h2>
<p>In RStudio there are 2 ways to save a plot. you can select the export button on the plots panel. this opens a save window where you can save as pdf or image.</p>
<p>Alternatively, you can save plots automatically from your script. there are 2 step for this approach. first you need to choose a graphic device i.e <code>pdf("filename")</code></p>
<pre class="r"><code>pdf(&quot;plot.pdf&quot;)</code></pre>
<p>then generate your plot</p>
<pre class="r"><code>plot(mtcars$hp~mtcars$mpg)</code></pre>
<p>your plot is now in the device. it will not be printed in rstudio. we can still add elements to it, for instance a trend line</p>
<pre class="r"><code>abline(lm(mtcars$hp ~ mtcars$mpg))</code></pre>
<p>to save your plot you need to release the graphic devices</p>
<pre class="r"><code>dev.off()</code></pre>
<p>The choice of device changes the output format. <code>pdf()</code> and <code>svg()</code> produce vector images where you can zoom the image without loosing quality and potentially edit the elements in Inkscape or Illustrator <a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> However, complex vector files (particularly of saved as svg) can get quite slow.</p>
<p><code>png()</code> will produce raster images, these are similar to photos, where you can’t zoom and get a sharperimage</p>
<p>Now go to your working directory and look for the plot. you should have gotten something like this</p>
<pre class="r fold-hide"><code>plot(mtcars$hp~mtcars$mpg)
abline(lm(mtcars$hp ~ mtcars$mpg))</code></pre>
<p><img src="session1_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
</div>
</div>
<div id="saving-data" class="section level1">
<h1>Saving data</h1>
<p>we can save files to a tabular format with write.table(). By default R add both rows and column names. Normally row names are not meaningful so we can omit them wuth <code>row.names = F</code>.</p>
<pre class="r"><code>write.table(cells, row.names = F, sep = &quot;,&quot;, file = &quot;table.csv&quot;)</code></pre>
<p>As with <code>read.csv()</code>, the <code>write.csv()</code> function is similar but has appropriate defaults for CSV files.</p>
<p>By default. this encloses any string in <code>""</code><br />
we can get rid of it by setting <code>quotes=FALSE</code>. There is normally no real need to do this.</p>
<pre class="r"><code>write.table(cells, row.names = FALSE, sep = &quot;,&quot;, file = &quot;table.csv&quot;, quote = FALSE)</code></pre>
<p>if append is TRUE R will add the current data to the specified file without overwriting it.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>In fact, unlike most languages in R any single variable that is not NULL is actually a vector of size 1<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Under the hood R might still do some copying<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This sounds excessively pedantic but consistency helps avoid silly typos when you want to refer to the columns by name later in your script<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>for instance, base R makes very heavy use of S3 objects. The model class resulting from lm() has a method for the <code>plot()</code> function. When we call <code>plot()</code> on a model it knows how to plot all the plots needed for a linear model because it can use the method in the S3 class model<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>unlike most programming languages that start from 0<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Unlike say Python, the last element is y, not y-1<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Although under the hood R will still possibly does some copying<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>Think of them like prions. Any operation with a <code>NA</code> will return <code>NA</code>, unless we remove them before<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>The bonferroni correction simply multiplies the p-value by the number of tests<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>The FALSE discovery ratio is explained here instead<a href="#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>Personally, as a rule of thumb I prefer using FDRs for everything that will get downstream validation<a href="#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Although changing the image adter is not recommended for reproducibility - R plots can be easily made publication ready<a href="#fnref12" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
